from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from ucimlrepo import fetch_ucirepo
import pandas as pd

# T·∫£i d·ªØ li·ªáu Iris
iris = fetch_ucirepo(id=53)
X = iris.data.features
y = iris.data.targets

# üëâ G·ªôp X v√† y l·∫°i chung 1 b·∫£ng
data = pd.concat([X, y], axis=1)

# Hi·ªÉn th·ªã 5 d√≤ng ƒë·∫ßu ti√™n
from IPython.display import display
display(data.head())
# 3Ô∏è‚É£ Th√¥ng tin t·ªïng qu√°t
# ==========================
print("\n=== Th√¥ng tin t·ªïng qu√°t ===")
data.info()

# ==========================
# 5Ô∏è‚É£ Ki·ªÉm tra gi√° tr·ªã b·ªã thi·∫øu
# ==========================
print("\n=== Ki·ªÉm tra gi√° tr·ªã b·ªã thi·∫øu ===")
print(data.isnull().sum())


# Chia d·ªØ li·ªáu
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# T·∫°o m√¥ h√¨nh
model = DecisionTreeClassifier()

# Hu·∫•n luy·ªán
model.fit(X_train, y_train)

# D·ª± ƒëo√°n
y_pred = model.predict(X_test)

# ƒê√°nh gi√°
print("\n===== K·∫øt qu·∫£ hu·∫•n luy·ªán =====")
print("ƒê·ªô ch√≠nh x√°c:", accuracy_score(y_test, y_pred))
